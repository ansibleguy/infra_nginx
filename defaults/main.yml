---

NGINX_MODE: "{{ nginx.mode | default('proxy') }}"  # proxy/redirect/serve
NGINX_PORT_PLAIN: "{{ nginx.port_plain | default(80) }}"
NGINX_PORT_SSL: "{{ nginx.port_ssl | default(443) }}"
NGINX_DOMAIN: "{{ nginx.domain | default('_') }}"
NGINX_ALIASES: "{{ nginx.aliases | default([]) }}"
NGINX_IP: "{{ nginx.ip | default('') }}"
NGINX_USER: "{{ nginx.user | default('nobody') }}"
NGINX_GROUP: "{{ nginx.group | default('nobody') }}"

# mode redirect
NGINX_REDIRECT: "{{ nginx_redirect | default('https://ansibleguy.net') }}"
NGINX_REDIRECT_REQUEST: "{{ nginx.redirect_request | default(true) }}"

# mode proxy
NGINX_PROXY_IP: "{{ nginx.proxy_ip | default('127.0.0.1') }}"
NGINX_PROXY_PORT: "{{ nginx.proxy_port | default(8080) }}"
NGINX_PROXY_PROTO: 'http'
NGINX_PROXY_HEADERS:
  Host: '$http_host'
  X-Forwarded-Host: '$host'
  X-Forwarded-Server: '$host'
  X-Forwarded-For: '$proxy_add_x_forwarded_for'
  X-Forwarded-Proto: '$scheme'
  X-Real-IP: '$remote_addr'

# mode server
NGINX_SERVE_PATH: "{{ nginx.serve_path | default('/var/www/html') }}"
NGINX_SERVE_INDEX: "{{ nginx.serve_index | default(['index.html']) }}"
NGINX_SERVE_403: "{{ nginx.serve_403 | default('') }}"
NGINX_SERVE_404: "{{ nginx.serve_404 | default('') }}"
NGINX_SERVE_500: "{{ nginx.serve_500 | default('') }}"

# ssl config
NGINX_CERT: 'local'  # local/letsencrypt
NGINX_CERT_PATH: "{{ nginx.cert_path | default('/etc/ssl') }}"
NGINX_CERT_PUB_PATH: "{{ nginx.cert_pub_path | default(NGINX_CERT_PATH + '/certs') }}"
NGINX_CERT_KEY_PATH: "{{ nginx.cert_key_path | default(NGINX_CERT_PATH + '/private') }}"
NGINX_CERT_PUB_FILE: "{{ nginx.cert_pub | default(NGINX_DOMAIN) }}.crt"  # should use the certificate chain => top is server cert; bottom root cert
NGINX_CERT_KEY_FILE: "{{ nginx.cert_key | default(NGINX_DOMAIN) }}.key"
NGINX_CERT_CSR_FILE: "{{ nginx.cert_csr | default(NGINX_DOMAIN) }}.csr"
NGINX_CERT_CA_FILE: "{{ nginx.cert_ca | default('') }}"
NGINX_CERT_CSR_DATA:
  country: 'AT'
  org: 'AnsibleGuy'
  email: 'guy@ansibleguy.net'
  cn: 'Nginx Certificate'

# other config
NGINX_LOG_DIR: "{{ nginx.log_dir | default('/var/log/nginx') }}"
NGINX_LOG_PER_SITE: "{{ nginx.log_per_site | default(true) }}"
NGINX_LOG_FORMAT: "main '$remote_addr - $remote_user [$time_local]  $status \"$request\" $body_bytes_sent \"$http_referer\" \"$http_user_agent\" \"$http_x_forwarded_for\"'"

NGINX_OPTIONS:
  autoindex: "{{ nginx.autoindex | default('off') }}"
  server_tokens: "{{ nginx.server_tokens | default('off') }}"
#  server_names_hash_bucket_size: "{{ nginx.server_names_hash_bucket_size | default(64) }}"
#  log_format: "{{ nginx.log_format | default(NGINX_LOG_FORMAT) }}"
  proxy_pass_request_headers: "{{ nginx.proxy_pass_request_headers | default('on') }}"
  proxy_connect_timeout: "{{ nginx.proxy_connect_timeout | default(150) }}"
  proxy_send_timeout: "{{ nginx.proxy_send_timeout | default(100) }}"
  proxy_read_timeout: "{{ nginx.proxy_read_timeout | default(100) }}"
  proxy_buffers: "{{ nginx.proxy_buffers | default('4 32k') }}"
  client_max_body_size: "{{ nginx.client_max_body_size | default('8m') }}"
  client_body_buffer_size: "{{ nginx.client_body_buffer_size | default('128k') }}"

NGINX_ADDITIONS: "{{ nginx.additional | default({}) }}"
